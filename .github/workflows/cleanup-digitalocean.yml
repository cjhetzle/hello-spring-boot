name: Free-Up Storage

on:
  schedule:
    - cron: '0 * * * *'
  workflow_dispatch:

jobs:

  run-garbage-collection:

    runs-on: ubuntu-latest

    steps:
      - name: GitHub Action for DigitalOcean - doctl üåä
        uses: digitalocean/action-doctl@v2.5.0
        with:
          token: ${{ secrets.DIGITALOCEAN_TOKEN }}
          
          
      - name: Authenticate to DigitalOcean üîê
        run: doctl registry login --expiry-seconds 600

      - name: Start Garbage Collection
        run: doctlregistry garbage-collection start ${{ vars.DIGITALOCEAN_CONTAINER_REGISTRY }} -f         
